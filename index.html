<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Proof-Easyï½œç°¡æ˜“æ ¡æ­£ãƒ„ãƒ¼ãƒ«</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background-color: #f7f9fa;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }
    .section {
      background: #fff;
      padding: 1rem;
      margin-bottom: 1.5rem;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }
    input[type="file"], textarea {
      width: 100%;
      margin-bottom: 1rem;
      font-family: monospace;
    }
    button {
      padding: 0.6rem 1.2rem;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    .result {
      background: #f0f0f0;
      padding: 1rem;
      white-space: pre-wrap;
      border-radius: 6px;
    }
    .error {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>ğŸ›  Proof-Easyï½œç°¡æ˜“æ ¡æ­£ãƒ„ãƒ¼ãƒ«ï¼ˆä¾¡æ ¼ãƒ»å·®åˆ†ãƒã‚§ãƒƒã‚¯ï¼‰</h1>

  <div class="section">
    <label>ãƒã‚§ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰é¸æŠï¼š</label>
    <label><input type="checkbox" id="modeA" checked /> Aï¼šå£²ä¾¡ãƒ»æ•°é‡ãƒã‚§ãƒƒã‚¯</label>
    <label><input type="checkbox" id="modeB" checked /> Bï¼šãƒ†ã‚­ã‚¹ãƒˆå·®åˆ†ãƒã‚§ãƒƒã‚¯</label>
  </div>

  <div class="section">
    <label>åŸç¨¿ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ†ã‚­ã‚¹ãƒˆè²¼ã‚Šä»˜ã‘ï¼‰</label>
    <textarea id="sourceText" rows="6" placeholder="ã“ã“ã«åŸç¨¿ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã£ã¦ãã ã•ã„"></textarea>
  </div>

  <div class="section">
    <label>å®Œæˆãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ†ã‚­ã‚¹ãƒˆè²¼ã‚Šä»˜ã‘ï¼‰</label>
    <textarea id="designText" rows="6" placeholder="ã“ã“ã«ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã£ã¦ãã ã•ã„"></textarea>
  </div>

  <button onclick="runCheck()">ãƒã‚§ãƒƒã‚¯ã™ã‚‹</button>

  <div id="result" class="result" style="margin-top: 1.5rem;"></div>

  <script>
    function runCheck() {
      const modeA = document.getElementById("modeA").checked;
      const modeB = document.getElementById("modeB").checked;
      const sourceText = document.getElementById("sourceText").value;
      const designText = document.getElementById("designText").value;
      const resultDiv = document.getElementById("result");
      let result = "";

      // Aãƒ¢ãƒ¼ãƒ‰ï¼šä¾¡æ ¼ãƒã‚§ãƒƒã‚¯
      if (modeA) {
        const priceRegex = /([1-9]\\d{2,4})å††ï¼ˆç¨æŠœä¾¡æ ¼([1-9]\\d{2,4})å††ï¼‰/g;
        const matches = [...designText.matchAll(priceRegex)];

        result += "ğŸ§¾ã€ä¾¡æ ¼ãƒã‚§ãƒƒã‚¯ã€‘\\n";
        if (matches.length === 0) {
          result += "âš  ä¾¡æ ¼ã®å½¢å¼ï¼ˆã€‡ã€‡å††ï¼ˆç¨æŠœä¾¡æ ¼â–³â–³å††ï¼‰ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“\\n";
        } else {
          for (const [_, taxInStr, taxExStr] of matches) {
            const taxIn = parseInt(taxInStr);
            const taxEx = parseInt(taxExStr);
            const calcIn = Math.round(taxEx * 1.08);
            if (calcIn !== taxIn) {
              result += `âŒ ${taxEx}å†† â†’ ç¨è¾¼ã¯ ${calcIn}å††ã®ã¯ãš â†’ å®Ÿéš›ã¯ ${taxIn}å††\\n`;
            } else {
              result += `âœ… ${taxEx}å†† â†’ ${taxIn}å††ï¼ˆOKï¼‰\\n`;
            }
          }
        }
        result += "\\n";
      }

      // Bãƒ¢ãƒ¼ãƒ‰ï¼šãƒ†ã‚­ã‚¹ãƒˆå·®åˆ†
      if (modeB) {
        const srcLines = sourceText.split(/\\r?\\n/);
        const desLines = designText.split(/\\r?\\n/);
        result += "ğŸ“„ã€å·®åˆ†ãƒã‚§ãƒƒã‚¯ã€‘\\n";
        srcLines.forEach((line, i) => {
          if (line !== desLines[i]) {
            result += `âš  ${i + 1}è¡Œç›®ï¼šåŸç¨¿ã€Œ${line}ã€ â‰  ãƒ‡ã‚¶ã‚¤ãƒ³ã€Œ${desLines[i] || "ï¼ˆãªã—ï¼‰"}ã€\\n`;
          }
        });
      }

      resultDiv.innerText = result || "âœ… ãƒã‚§ãƒƒã‚¯å®Œäº†ï¼šå•é¡Œã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚";
    }
  </script>
</body>
</html>
